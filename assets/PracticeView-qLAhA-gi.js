import{H as xt,a0 as kt,a6 as b,a9 as e,h as V,a5 as v,a7 as At,a8 as d,n as l,Z as s,o,ae as S,F as N,af as T,V as u,ag as $,v as Z,j as Q}from"./vendor-TecACWjj.js";import{u as St}from"./progress-CqnHXEfv.js";import{g as Ct,a as It,b as wt}from"./quizzes-BRUEq-FN.js";import{g as zt}from"./taiwan-geography-CPnPTjtf.js";import{_ as Vt}from"./_plugin-vue_export-helper-DlAUqK2U.js";const Qt={class:"mb-6"},ht={class:"text-center"},$t={class:"text-h4 font-weight-bold"},Pt={class:"text-center"},Nt={class:"text-h4 font-weight-bold"},Tt={class:"text-center"},jt={class:"text-h4 font-weight-bold"},Ut={class:"text-center"},Lt={class:"text-h4 font-weight-bold"},Mt={class:"text-h5"},Ot={class:"text-caption"},Bt={class:"text-right"},Jt={class:"mb-6"},qt={class:"text-h6 mb-4"},Et={key:3,class:"mb-4"},Rt={class:"text-center mb-6"},Ft={class:"text-h6 mt-2"},Dt={class:"text-right mt-4"},Ht={class:"mb-2"},Zt={class:"mb-2"},Gt={class:"mb-2"},Kt={key:0},Wt={__name:"PracticeView",setup(Xt){const F=At(),J=St(),c=V(null),m=V(0),C=V([]),j=V(!1),L=V([]),z=V(0),M=V(0);let h=null;const q=V(Ct()),G=V(zt()),K=Q(()=>It()),W=Q(()=>wt()),X=Q(()=>J.averageScore),Y=Q(()=>Object.keys(J.progress.quizScores).length),I=Q(()=>c.value?c.value.questions[m.value]:null),tt=Q(()=>c.value?(m.value+1)/c.value.questionsCount*100:0),et=Q(()=>c.value?c.value.questions.reduce((r,t)=>r+t.points,0):0),lt=Q(()=>z.value>=80?"text-green":z.value>=60?"text-orange":"text-red"),st=Q(()=>z.value>=90?"太棒了！你是地理小博士！":z.value>=80?"優秀！你的地理知識很扎實！":z.value>=60?"不錯！繼續努力可以更好！":"加油！再多複習一下會更好！"),ot=r=>{switch(r){case"初級":return"green-lighten-5";case"中級":return"blue-lighten-5";case"高級":return"orange-lighten-5";default:return"grey-lighten-5"}},at=r=>{const t=G.value.find(a=>a.id===r);return t?t.title:"未知主題"},O=r=>{c.value={...r},m.value=0,C.value=new Array(r.questionsCount).fill(null).map((t,a)=>{const i=r.questions[a];return i.type==="matching"&&i.leftItems?new Array(i.leftItems.length).fill(null):null}),j.value=!1,L.value=[],z.value=0,M.value=r.timeLimit,nt()},D=r=>{O(q.value[0])},nt=()=>{h&&clearInterval(h),h=setInterval(()=>{M.value>0?M.value--:H()},1e3)},rt=r=>{const t=Math.floor(r/60),a=r%60;return`${t.toString().padStart(2,"0")}:${a.toString().padStart(2,"0")}`},ut=()=>{m.value>0&&m.value--},it=()=>{m.value<c.value.questionsCount-1&&m.value++},H=()=>{h&&(clearInterval(h),h=null);let r=0;const t=[];c.value.questions.forEach((a,i)=>{const g=C.value[i],p=a.correctAnswer;let f=!1,x=0;switch(a.type){case"single-choice":case"true-false":f=g===p;break;case"multiple-choice":if(Array.isArray(g)&&Array.isArray(p)){const P=[...g].sort(),k=[...p].sort();f=JSON.stringify(P)===JSON.stringify(k)}break;case"matching":if(Array.isArray(g)&&Array.isArray(a.correctPairs)){const P=g.map((A,w)=>[w,A]),k=a.correctPairs,U=[...P].sort((A,w)=>A[0]-w[0]||A[1]-w[1]),E=[...k].sort((A,w)=>A[0]-w[0]||A[1]-w[1]);f=JSON.stringify(U)===JSON.stringify(E)}break}x=f?a.points:0,r+=x;let y=p;a.type==="matching"&&a.correctPairs&&(y=a.correctPairs),t.push({question:a,userAnswer:g,correctAnswer:y,correct:f,points:x})}),L.value=t,z.value=r,j.value=!0,c.value.topicId&&J.updateQuizScore(c.value.topicId,r)},B=(r,t)=>{if(r==null)return"未回答";switch(t.type){case"single-choice":return t.options[r]||"無效答案";case"multiple-choice":return Array.isArray(r)&&r.map(a=>t.options[a]).join(", ")||"無效答案";case"true-false":return r?"正確":"錯誤";case"matching":return Array.isArray(r)?r.length>0&&Array.isArray(r[0])?r.map(([a,i])=>{const g=t.leftItems[a]||`項目${a}`,p=t.rightItems[i]||`選項${i}`;return`${g} → ${p}`}).join("; "):r.map((a,i)=>{const g=t.leftItems[i]||`項目${i}`,p=t.rightItems[a]||`選項${a}`;return`${g} → ${p}`}).join("; "):"無效答案";default:return String(r)}},dt=()=>{c.value&&O(c.value)},ct=()=>{c.value&&c.value.topicId?F.push({name:"study",query:{topic:c.value.topicId}}):F.push({name:"study"})},vt=()=>{c.value=null,j.value=!1};return xt(()=>{const t=new URLSearchParams(window.location.search).get("topic");if(t&&!isNaN(t)){const a=parseInt(t),i=q.value.find(g=>g.topicId===a);i&&O(i)}}),kt(()=>{h&&clearInterval(h)}),(r,t)=>{const a=v("v-icon"),i=v("v-card-title"),g=v("v-card-subtitle"),p=v("v-card"),f=v("v-col"),x=v("v-row"),y=v("v-chip"),P=v("v-card-text"),k=v("v-btn"),U=v("v-card-actions"),E=v("v-progress-linear"),A=v("v-radio"),w=v("v-radio-group"),ft=v("v-checkbox"),mt=v("v-select"),pt=v("v-table"),_t=v("v-expansion-panel-text"),gt=v("v-expansion-panel"),yt=v("v-expansion-panels"),bt=v("v-container");return d(),b(bt,{class:"pa-4"},{default:e(()=>[l(x,{class:"mb-4"},{default:e(()=>[l(f,{cols:"12"},{default:e(()=>[l(p,{color:"green-darken-2",dark:"",class:"pa-4 rounded-lg"},{default:e(()=>[l(i,{class:"text-h4 font-weight-bold"},{default:e(()=>[l(a,{large:"",left:""},{default:e(()=>[...t[5]||(t[5]=[s("mdi-check-circle",-1)])]),_:1}),t[6]||(t[6]=s(" 練習中心 ",-1))]),_:1}),l(g,{class:"text-h6 mt-2"},{default:e(()=>[...t[7]||(t[7]=[s(" 互動練習題庫 - 超過200題會考題型，加強你的解題能力 ",-1)])]),_:1})]),_:1})]),_:1})]),_:1}),!c.value&&!j.value?(d(),b(x,{key:0,class:"mb-6"},{default:e(()=>[l(f,{cols:"12"},{default:e(()=>[l(p,{class:"pa-4"},{default:e(()=>[l(i,{class:"text-h5 mb-4"},{default:e(()=>[l(a,{left:"",color:"primary"},{default:e(()=>[...t[8]||(t[8]=[s("mdi-format-list-checks",-1)])]),_:1}),t[9]||(t[9]=s(" 選擇測驗類型 ",-1))]),_:1}),o("div",Qt,[t[11]||(t[11]=o("h3",{class:"text-h6 mb-3"},"主題測驗",-1)),l(x,null,{default:e(()=>[(d(!0),S(N,null,T(q.value,n=>(d(),b(f,{key:n.id,cols:"12",md:"6",lg:"4"},{default:e(()=>[l(p,{class:"pa-4 h-100",color:ot(n.difficulty),variant:"outlined",hover:"",onClick:_=>O(n)},{default:e(()=>[l(i,{class:"text-h6"},{default:e(()=>[s(u(n.title),1)]),_:2},1024),l(g,{class:"mb-2"},{default:e(()=>[l(y,{size:"small",class:"mr-1"},{default:e(()=>[s(u(n.difficulty),1)]),_:2},1024),l(y,{size:"small"},{default:e(()=>[s(u(n.questionsCount)+" 題",1)]),_:2},1024),l(y,{size:"small",class:"ml-1"},{default:e(()=>[s(u(Math.floor(n.timeLimit/60))+" 分鐘",1)]),_:2},1024)]),_:2},1024),l(P,null,{default:e(()=>[s(" 主題："+u(at(n.topicId)),1)]),_:2},1024),l(U,null,{default:e(()=>[l(k,{color:"primary",block:""},{default:e(()=>[...t[10]||(t[10]=[s(" 開始測驗 ",-1)])]),_:1})]),_:1})]),_:2},1032,["color","onClick"])]),_:2},1024))),128))]),_:1})]),o("div",null,[t[24]||(t[24]=o("h3",{class:"text-h6 mb-3"},"模擬會考",-1)),l(x,null,{default:e(()=>[l(f,{cols:"12",md:"6"},{default:e(()=>[l(p,{class:"pa-4",color:"orange-lighten-5",variant:"outlined",hover:"",onClick:t[0]||(t[0]=n=>D("easy"))},{default:e(()=>[l(i,{class:"text-h6"},{default:e(()=>[l(a,{left:"",color:"orange"},{default:e(()=>[...t[12]||(t[12]=[s("mdi-school",-1)])]),_:1}),t[13]||(t[13]=s(" 基礎模擬考 ",-1))]),_:1}),l(g,{class:"mb-2"},{default:e(()=>[l(y,{size:"small",class:"mr-1"},{default:e(()=>[...t[14]||(t[14]=[s("初級",-1)])]),_:1}),l(y,{size:"small"},{default:e(()=>[...t[15]||(t[15]=[s("30 題",-1)])]),_:1}),l(y,{size:"small",class:"ml-1"},{default:e(()=>[...t[16]||(t[16]=[s("45 分鐘",-1)])]),_:1})]),_:1}),l(P,null,{default:e(()=>[...t[17]||(t[17]=[s(" 適合剛開始複習的學生，題目較為基礎。 ",-1)])]),_:1})]),_:1})]),_:1}),l(f,{cols:"12",md:"6"},{default:e(()=>[l(p,{class:"pa-4",color:"red-lighten-5",variant:"outlined",hover:"",onClick:t[1]||(t[1]=n=>D("hard"))},{default:e(()=>[l(i,{class:"text-h6"},{default:e(()=>[l(a,{left:"",color:"red"},{default:e(()=>[...t[18]||(t[18]=[s("mdi-trophy",-1)])]),_:1}),t[19]||(t[19]=s(" 進階模擬考 ",-1))]),_:1}),l(g,{class:"mb-2"},{default:e(()=>[l(y,{size:"small",class:"mr-1"},{default:e(()=>[...t[20]||(t[20]=[s("高級",-1)])]),_:1}),l(y,{size:"small"},{default:e(()=>[...t[21]||(t[21]=[s("50 題",-1)])]),_:1}),l(y,{size:"small",class:"ml-1"},{default:e(()=>[...t[22]||(t[22]=[s("60 分鐘",-1)])]),_:1})]),_:1}),l(P,null,{default:e(()=>[...t[23]||(t[23]=[s(" 挑戰性題目，適合準備衝刺的學生。 ",-1)])]),_:1})]),_:1})]),_:1})]),_:1})]),l(p,{class:"pa-4 mt-6",color:"blue-lighten-5"},{default:e(()=>[l(i,{class:"text-h6"},{default:e(()=>[l(a,{left:"",color:"blue"},{default:e(()=>[...t[25]||(t[25]=[s("mdi-chart-bar",-1)])]),_:1}),t[26]||(t[26]=s(" 測驗統計 ",-1))]),_:1}),l(x,null,{default:e(()=>[l(f,{cols:"6",md:"3"},{default:e(()=>[o("div",ht,[o("div",$t,u(K.value),1),t[27]||(t[27]=o("div",{class:"text-caption"},"測驗總數",-1))])]),_:1}),l(f,{cols:"6",md:"3"},{default:e(()=>[o("div",Pt,[o("div",Nt,u(W.value),1),t[28]||(t[28]=o("div",{class:"text-caption"},"題目總數",-1))])]),_:1}),l(f,{cols:"6",md:"3"},{default:e(()=>[o("div",Tt,[o("div",jt,u(X.value)+"/100",1),t[29]||(t[29]=o("div",{class:"text-caption"},"平均分數",-1))])]),_:1}),l(f,{cols:"6",md:"3"},{default:e(()=>[o("div",Ut,[o("div",Lt,u(Y.value),1),t[30]||(t[30]=o("div",{class:"text-caption"},"已完成測驗",-1))])]),_:1})]),_:1})]),_:1})]),_:1})]),_:1})]),_:1})):$("",!0),c.value&&!j.value?(d(),b(x,{key:1},{default:e(()=>[l(f,{cols:"12"},{default:e(()=>[l(p,{class:"pa-4"},{default:e(()=>[l(i,{class:"d-flex justify-space-between align-center"},{default:e(()=>[o("div",null,[o("h2",Mt,u(c.value.title),1),o("div",Ot," 第 "+u(m.value+1)+" 題 / "+u(c.value.questionsCount),1)]),o("div",Bt,[l(y,{color:"primary",size:"large"},{default:e(()=>[l(a,{left:""},{default:e(()=>[...t[31]||(t[31]=[s("mdi-timer",-1)])]),_:1}),s(" "+u(rt(M.value)),1)]),_:1})])]),_:1}),l(E,{"model-value":tt.value,height:"10",color:"primary",class:"my-4"},null,8,["model-value"]),o("div",Jt,[o("h3",qt,u(I.value.question),1),I.value.type==="single-choice"?(d(),b(w,{key:0,modelValue:C.value[m.value],"onUpdate:modelValue":t[2]||(t[2]=n=>C.value[m.value]=n)},{default:e(()=>[(d(!0),S(N,null,T(I.value.options,(n,_)=>(d(),b(A,{key:_,label:n,value:_,class:"mb-2"},null,8,["label","value"]))),128))]),_:1},8,["modelValue"])):$("",!0),I.value.type==="multiple-choice"?(d(!0),S(N,{key:1},T(I.value.options,(n,_)=>(d(),b(ft,{key:_,modelValue:C.value[m.value],"onUpdate:modelValue":t[3]||(t[3]=R=>C.value[m.value]=R),label:n,value:_,multiple:"",class:"mb-1"},null,8,["modelValue","label","value"]))),128)):$("",!0),I.value.type==="true-false"?(d(),b(w,{key:2,modelValue:C.value[m.value],"onUpdate:modelValue":t[4]||(t[4]=n=>C.value[m.value]=n)},{default:e(()=>[l(A,{label:"正確",value:!0,class:"mb-2"}),l(A,{label:"錯誤",value:!1})]),_:1},8,["modelValue"])):$("",!0),I.value.type==="matching"?(d(),S("div",Et,[l(x,null,{default:e(()=>[l(f,{cols:"6"},{default:e(()=>[(d(!0),S(N,null,T(I.value.leftItems,(n,_)=>(d(),S("div",{key:_,class:"mb-2"},[l(y,null,{default:e(()=>[s(u(n),1)]),_:2},1024)]))),128))]),_:1}),l(f,{cols:"6"},{default:e(()=>[(d(!0),S(N,null,T(I.value.leftItems,(n,_)=>(d(),b(mt,{key:_,modelValue:C.value[m.value][_],"onUpdate:modelValue":R=>C.value[m.value][_]=R,items:I.value.rightItems,label:`配對：${n}`,class:"mb-2"},null,8,["modelValue","onUpdate:modelValue","items","label"]))),128))]),_:1})]),_:1})])):$("",!0)]),l(U,{class:"d-flex justify-space-between"},{default:e(()=>[l(k,{color:"grey",onClick:ut,disabled:m.value===0},{default:e(()=>[l(a,{left:""},{default:e(()=>[...t[32]||(t[32]=[s("mdi-chevron-left",-1)])]),_:1}),t[33]||(t[33]=s(" 上一題 ",-1))]),_:1},8,["disabled"]),o("div",null,[m.value<c.value.questionsCount-1?(d(),b(k,{key:0,color:"primary",onClick:it},{default:e(()=>[t[35]||(t[35]=s(" 下一題 ",-1)),l(a,{right:""},{default:e(()=>[...t[34]||(t[34]=[s("mdi-chevron-right",-1)])]),_:1})]),_:1})):(d(),b(k,{key:1,color:"success",onClick:H},{default:e(()=>[l(a,{left:""},{default:e(()=>[...t[36]||(t[36]=[s("mdi-check",-1)])]),_:1}),t[37]||(t[37]=s(" 提交測驗 ",-1))]),_:1}))])]),_:1})]),_:1})]),_:1})]),_:1})):$("",!0),j.value?(d(),b(x,{key:2},{default:e(()=>[l(f,{cols:"12"},{default:e(()=>[l(p,{class:"pa-4"},{default:e(()=>[l(i,{class:"text-h4 mb-4 text-center"},{default:e(()=>[l(a,{large:"",left:"",color:"success"},{default:e(()=>[...t[38]||(t[38]=[s("mdi-trophy",-1)])]),_:1}),t[39]||(t[39]=s(" 測驗完成！ ",-1))]),_:1}),o("div",Rt,[o("div",{class:Z(["text-h1 font-weight-bold",lt.value])},u(z.value)+"/100 ",3),o("div",Ft,u(st.value),1)]),l(p,{class:"pa-4 mb-4"},{default:e(()=>[l(i,{class:"text-h6"},{default:e(()=>[...t[40]||(t[40]=[s(" 測驗詳細結果 ",-1)])]),_:1}),l(pt,null,{default:e(()=>[t[41]||(t[41]=o("thead",null,[o("tr",null,[o("th",null,"題號"),o("th",null,"你的答案"),o("th",null,"正確答案"),o("th",null,"得分")])],-1)),o("tbody",null,[(d(!0),S(N,null,T(L.value,(n,_)=>(d(),S("tr",{key:_,class:Z(n.correct?"correct-row":"incorrect-row")},[o("td",null,u(_+1),1),o("td",null,u(B(n.userAnswer,n.question)),1),o("td",null,u(B(n.correctAnswer,n.question)),1),o("td",null,u(n.points),1)],2))),128))])]),_:1}),o("div",Dt,[o("strong",null,"總分："+u(z.value)+" / "+u(et.value),1)])]),_:1}),l(yt,{class:"mb-4"},{default:e(()=>[(d(!0),S(N,null,T(L.value,(n,_)=>(d(),b(gt,{key:_,title:`第 ${_+1} 題：${n.question.question.substring(0,50)}...`},{default:e(()=>[l(_t,null,{default:e(()=>[o("div",Ht,[t[42]||(t[42]=o("strong",null,"題目：",-1)),s(u(n.question.question),1)]),o("div",Zt,[t[43]||(t[43]=o("strong",null,"你的答案：",-1)),s(u(B(n.userAnswer,n.question)),1)]),o("div",Gt,[t[44]||(t[44]=o("strong",null,"正確答案：",-1)),s(u(B(n.correctAnswer,n.question)),1)]),n.question.explanation?(d(),S("div",Kt,[t[45]||(t[45]=o("strong",null,"解析：",-1)),s(u(n.question.explanation),1)])):$("",!0)]),_:2},1024)]),_:2},1032,["title"]))),128))]),_:1}),l(U,{class:"d-flex justify-center"},{default:e(()=>[l(k,{color:"primary",onClick:dt,class:"mr-2"},{default:e(()=>[l(a,{left:""},{default:e(()=>[...t[46]||(t[46]=[s("mdi-refresh",-1)])]),_:1}),t[47]||(t[47]=s(" 重新測驗 ",-1))]),_:1}),l(k,{color:"success",onClick:ct,class:"mr-2"},{default:e(()=>[l(a,{left:""},{default:e(()=>[...t[48]||(t[48]=[s("mdi-book-open",-1)])]),_:1}),t[49]||(t[49]=s(" 學習相關主題 ",-1))]),_:1}),l(k,{color:"grey",onClick:vt},{default:e(()=>[l(a,{left:""},{default:e(()=>[...t[50]||(t[50]=[s("mdi-format-list-checks",-1)])]),_:1}),t[51]||(t[51]=s(" 返回測驗列表 ",-1))]),_:1})]),_:1})]),_:1})]),_:1})]),_:1})):$("",!0)]),_:1})}}},oe=Vt(Wt,[["__scopeId","data-v-0da0ad16"]]);export{oe as default};
